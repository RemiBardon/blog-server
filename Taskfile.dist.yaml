# See <https://taskfile.dev/usage> and <https://taskfile.dev/reference/schema>
# to find all keys and their usage.
version: "3"

silent: true

tasks:
  test:
    desc: Tests that the server builds.
    cmds:
      - task: build
      - task: run

  build:
    internal: true
    cmd: cargo install --path orangutan/src/orangutan-server

  run:
    internal: true
    dotenv: [.env]
    env:
      LOCALHOST: true
      RUST_LOG: info,orangutan_server=trace,orangutan_helpers::generate=debug,hyper=info
    cmd: orangutan-server

  local:build:
    internal: true
    dotenv: [.env]
    cmd: cargo install --path "${ORANGUTAN_REPOSITORY:?}"/src/orangutan-server

  local:test:
    desc: Tests that the server builds with unreleased server.
    cmds:
      - task: local:build
      - task: run
